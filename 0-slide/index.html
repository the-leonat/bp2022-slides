<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>1</title>
        <style>
            html,
            body {
                margin: 0;
                padding: 0;
            }

            span,
            button {
                position: absolute;
                font-size: 2vw;
            }

            span.word {
                top: 5vh;
                right: 5vw;
                max-width: 50vw;
                background: orange;

            }

            span.url {
                bottom: 5vh;
                right: 5vw;
                background: lightblue;
            }

            span {
                padding: 1vw;
                word-wrap: break-word;
                text-shadow: 1px 1px white;
                text-align: right;
                border-radius: 100%;
            }

            button.next {
                top: 5vh;
                left: 12vw;
            }
            button.prev {
                top: 5vh;
                left: 5vw;
            }

            .img-container,
            iframe {
                width: 100vw;
                height: 100vh;
                display: none;
                border: none;
            }

            .img-container {
                font-size: 0;
            }

            img {
                width: 50%;
                display: inline-block;
                height: 50%;
                object-fit: contain;
            }
        </style>
    </head>

    <body>
        <button class="prev">&lt;&lt;&lt;&lt;</button>
        <button class="next">>>>></button>
        <span class="word"></span>
        <span class="url"></span>
        <div class="img-container">
            <img src="" />
            <img src="" />
            <img src="" />
            <img src="" />
        </div>
        <iframe src=""></iframe>
        <script>
            const text = `test 10 9 8 7 6 5 4 3 2 1
                hello my name is leonard i want to show you a few things i have done
                http://numbers.by.leonat.de
                https://leonat.de/cursors
                end
                `
                .split(" ")
                .filter((word) => word !== "");
            let index =  parseInt(window.location.hash?.substr(1) || 0);
            console.log(index)
            const spanWord = document.querySelector("span.word");
            const spanUrl = document.querySelector("span.url");

            const imgContainer = document.querySelector(".img-container");
            const images = document.querySelectorAll("img");
            const iframe = document.querySelector("iframe");
            const buttonNext = document.querySelector("button.next");
            const buttonPrev = document.querySelector("button.prev");
            updateWord(0);
            async function updateWord(step) {
                if (index + step >= text.length) return;
                index += step;
                window.location.hash = index;
                const currentWord = text[index];
                if (currentWord?.startsWith("http")) {
                    imgContainer.style.display = "none";
                    iframe.style.display = "block";
                    spanWord.style.display = "none";
                    spanUrl.innerHTML = currentWord;
                    iframe.setAttribute("src", currentWord);
                    images.forEach((img, index) => img.setAttribute("src", ""))
                } else {
                    imgContainer.style.display = "block";
                    iframe.style.display = "none";
                    spanWord.style.display = "block";
                    const req = await fetch(
                        `http://localhost:8080/${currentWord}`
                    );
                    const { imgUrls, searchUrl } = await req.json();
                    images.forEach((img, index) => img.setAttribute("src", imgUrls[index]))
                    spanUrl.innerHTML = `${searchUrl}`;  
                    spanWord.innerHTML = currentWord;
                }
            }
            buttonPrev.addEventListener("click", () => {
                updateWord(-1);
            });
            buttonNext.addEventListener("click", () => {
                updateWord(+1);
            });
        </script>
    </body>
</html>
